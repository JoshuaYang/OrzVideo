!function(t){"use strict";if(t.Uint8Array){var e=function(){return t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)}}(),i=t.jsmpeg=function(t,e){e=e||{},this.benchmark=!!e.benchmark,this.canvas=e.canvas||document.createElement("canvas"),this.autoplay=!!e.autoplay,this.loop=!!e.loop,this.seekable=!!e.seekable,this.externalLoadCallback=e.onload||null,this.externalDecodeCallback=e.ondecodeframe||null,this.externalFinishedCallback=e.onfinished||null,this.customIntraQuantMatrix=new Uint8Array(64),this.customNonIntraQuantMatrix=new Uint8Array(64),this.blockData=new Int32Array(64),this.zeroBlockData=new Int32Array(64),this.fillArray(this.zeroBlockData,0),!e.forceCanvas2D&&this.initWebGL()?this.renderFrame=this.renderFrameGL:(this.canvasContext=this.canvas.getContext("2d"),this.renderFrame=this.renderFrame2D),t instanceof WebSocket?(this.client=t,this.client.onopen=this.initSocketClient.bind(this)):e.preload?(this.load(t),this.beginLoad=!0):this.url=t};i.prototype.waitForIntraFrame=!0,i.prototype.socketBufferSize=524288,i.prototype.initSocketClient=function(t){this.buffer=new R(new ArrayBuffer(this.socketBufferSize)),this.nextPictureBuffer=new R(new ArrayBuffer(this.socketBufferSize)),this.nextPictureBuffer.writePos=0,this.nextPictureBuffer.chunkBegin=0,this.nextPictureBuffer.lastWriteBeforeWrap=0,this.client.binaryType="arraybuffer",this.client.onmessage=this.receiveSocketMessage.bind(this)},i.prototype.decodeSocketHeader=function(t){t[0]==r.charCodeAt(0)&&t[1]==r.charCodeAt(1)&&t[2]==r.charCodeAt(2)&&t[3]==r.charCodeAt(3)&&(this.width=256*t[4]+t[5],this.height=256*t[6]+t[7],this.initBuffers())},i.prototype.receiveSocketMessage=function(t){var i=new Uint8Array(t.data);this.sequenceStarted||this.decodeSocketHeader(i);var r=this.buffer,s=this.nextPictureBuffer;s.writePos+i.length>s.length&&(s.lastWriteBeforeWrap=s.writePos,s.writePos=0,s.index=0),s.bytes.set(i,s.writePos),s.writePos+=i.length;for(var a=0;;){if(a=s.findNextMPEGStartCode(),a==R.NOT_FOUND||s.index>>3>s.writePos)return void(s.index=Math.max(s.writePos-3,0)<<3);if(a==k)break}if(this.waitForIntraFrame)return s.advance(10),void(s.getBits(3)==g&&(this.waitForIntraFrame=!1,s.chunkBegin=s.index-13>>3));this.currentPictureDecoded||this.decodePicture(o);var n=s.index>>3;if(n>s.chunkBegin)r.bytes.set(s.bytes.subarray(s.chunkBegin,n)),r.writePos=n-s.chunkBegin;else{r.bytes.set(s.bytes.subarray(s.chunkBegin,s.lastWriteBeforeWrap));var h=s.lastWriteBeforeWrap-s.chunkBegin;r.bytes.set(s.bytes.subarray(0,n),h),r.writePos=n+h}r.index=0,s.chunkBegin=n,this.currentPictureDecoded=!1,e(this.scheduleDecoding.bind(this),this.canvas)},i.prototype.scheduleDecoding=function(){this.decodePicture(),this.currentPictureDecoded=!0},i.prototype.isRecording=!1,i.prototype.recorderWaitForIntraFrame=!1,i.prototype.recordedFrames=0,i.prototype.recordedSize=0,i.prototype.didStartRecordingCallback=null,i.prototype.recordBuffers=[],i.prototype.canRecord=function(){return this.client&&this.client.readyState==this.client.OPEN},i.prototype.startRecording=function(t){if(this.canRecord()){this.discardRecordBuffers(),this.isRecording=!0,this.recorderWaitForIntraFrame=!0,this.didStartRecordingCallback=t||null,this.recordedFrames=0,this.recordedSize=0;var e=this.width>>4,i=(15&this.width)<<4|this.height>>8,r=255&this.height;this.recordBuffers.push(new Uint8Array([0,0,1,179,e,i,r,19,255,255,225,88,0,0,1,184,0,8,0,0,0,0,1,0]))}},i.prototype.recordFrameFromCurrentBuffer=function(){if(this.isRecording){if(this.recorderWaitForIntraFrame){if(this.pictureCodingType!=g)return;this.recorderWaitForIntraFrame=!1,this.didStartRecordingCallback&&this.didStartRecordingCallback(this)}this.recordedFrames++,this.recordedSize+=this.buffer.writePos,this.recordBuffers.push(new Uint8Array(this.buffer.bytes.subarray(0,this.buffer.writePos)))}},i.prototype.discardRecordBuffers=function(){this.recordBuffers=[],this.recordedFrames=0},i.prototype.stopRecording=function(){var t=new Blob(this.recordBuffers,{type:"video/mpeg"});return this.discardRecordBuffers(),this.isRecording=!1,t},i.prototype.intraFrames=[],i.prototype.currentFrame=-1,i.prototype.currentTime=0,i.prototype.frameCount=0,i.prototype.duration=0,i.prototype.load=function(t){this.url=t;var e=new XMLHttpRequest,i=this;e.onreadystatechange=function(){e.readyState==e.DONE&&200==e.status&&i.loadCallback(e.response)},e.onprogress=this.gl?this.updateLoaderGL.bind(this):this.updateLoader2D.bind(this),e.open("GET",t),e.responseType="arraybuffer",e.send()},i.prototype.updateLoader2D=function(t){var e=t.loaded/t.total,i=this.canvas.width,r=this.canvas.height,o=this.canvasContext;o.fillStyle="#222",o.fillRect(0,0,i,r),o.fillStyle="#fff",o.fillRect(0,r-r*e,i,r*e)},i.prototype.updateLoaderGL=function(t){var e=this.gl;e.uniform1f(e.getUniformLocation(this.loadingProgram,"loaded"),t.loaded/t.total),e.drawArrays(e.TRIANGLE_STRIP,0,4)},i.prototype.loadCallback=function(t){this.buffer=new R(t),this.seekable&&(this.collectIntraFrames(),this.buffer.index=0),this.findStartCode(C),this.firstSequenceHeader=this.buffer.index,this.decodeSequenceHeader(),this.duration=this.frameCount/this.pictureRate,this.nextFrame(),this.autoplay&&this.play("none"),this.externalLoadCallback&&this.externalLoadCallback(this)},i.prototype.collectIntraFrames=function(){var t;for(t=0;this.findStartCode(k)!==R.NOT_FOUND;t++)this.buffer.advance(10),this.buffer.getBits(3)==g&&this.intraFrames.push({frame:t,index:this.buffer.index-13});this.frameCount=t},i.prototype.seekToFrame=function(t,e){if(this.seeking=!0,0>t||t>=this.frameCount||!this.intraFrames.length)return!1;for(var i=null,r=0;r<this.intraFrames.length&&this.intraFrames[r].frame<=t;r++)i=this.intraFrames[r];if(this.buffer.index=i.index,this.currentFrame=i.frame-1,e){for(var s=i.frame;t>s;s++)this.decodePicture(o),this.findStartCode(k);this.currentFrame=t-1}return this.decodePicture(),!0},i.prototype.seekToTime=function(t,e){this.seekToFrame(t*this.pictureRate|0,e)},i.prototype.play=function(t){return this.beginLoad?void(this.playing||(this._audioCurrentTime=-1,this.targetTime=this.now(),this.playing=!0,this.scheduleNextFrame())):(this.load(this.url),void(this.beginLoad=!0))},i.prototype.pause=function(t){this.playing=!1,this._audioCurrentTime=-1},i.prototype.stop=function(t){this._audioCurrentTime=-1,this.currentFrame=-1,this.buffer&&(this.buffer.index=this.firstSequenceHeader),this.playing=!1,this.client&&(this.client.close(),this.client=null)},i.prototype.readCode=function(t){var e=0;do e=t[e+this.buffer.getBits(1)];while(e>=0&&0!=t[e]);return t[e+2]},i.prototype.findStartCode=function(t){for(var e=0;;){if("function"!=typeof this.buffer.findNextMPEGStartCode)break;if(e=this.buffer.findNextMPEGStartCode(),e==t||e==R.NOT_FOUND)return e}return R.NOT_FOUND},i.prototype.fillArray=function(t,e){for(var i=0,r=t.length;r>i;i++)t[i]=e},i.prototype.pictureRate=30,i.prototype.lateTime=0,i.prototype.firstSequenceHeader=0,i.prototype.targetTime=0,i.prototype.benchmark=!1,i.prototype.benchFrame=0,i.prototype.benchDecodeTimes=0,i.prototype.benchAvgFrameTime=0,i.prototype.now=function(){return t.performance?t.performance.now():Date.now()},i.prototype.nextFrame=function(){if(this.buffer)for(var t=this.now();;){if("function"!=typeof this.buffer.findNextMPEGStartCode)break;var e=this.buffer.findNextMPEGStartCode();if(e==C)this.decodeSequenceHeader();else{if(e==k)return this.playing&&this.scheduleNextFrame(),this.decodePicture(),this.benchDecodeTimes+=this.now()-t,this.canvas;if(e==R.NOT_FOUND)return this.stop(),this.externalFinishedCallback&&this.externalFinishedCallback(this),this.loop&&this.sequenceStarted&&this.play(),null}}},i.prototype.scheduleNextFrame=function(){this.lateTime=this.now()-this.targetTime;var e=Math.max(0,1e3/this.pictureRate-this.lateTime);this.targetTime=this.now()+e,this.benchmark?(this.benchFrame++,this.benchFrame>=120&&(this.benchAvgFrameTime=this.benchDecodeTimes/this.benchFrame,this.benchFrame=0,this.benchDecodeTimes=0,t.console&&console.log("Average time per frame:",this.benchAvgFrameTime,"ms")),setTimeout(this.nextFrame.bind(this),0)):18>e?this.scheduleAnimation():setTimeout(this.scheduleAnimation.bind(this),e)},i.prototype.scheduleAnimation=function(){e(this.nextFrame.bind(this),this.canvas)},i.prototype.decodeSequenceHeader=function(){if(this.width=this.buffer.getBits(12),this.height=this.buffer.getBits(12),this.buffer.advance(4),this.pictureRate=s[this.buffer.getBits(4)],this.buffer.advance(30),this.initBuffers(),this.buffer.getBits(1)){for(var t=0;64>t;t++)this.customIntraQuantMatrix[a[t]]=this.buffer.getBits(8);this.intraQuantMatrix=this.customIntraQuantMatrix}if(this.buffer.getBits(1)){for(var t=0;64>t;t++)this.customNonIntraQuantMatrix[a[t]]=this.buffer.getBits(8);this.nonIntraQuantMatrix=this.customNonIntraQuantMatrix}},i.prototype.initBuffers=function(){if(this.intraQuantMatrix=n,this.nonIntraQuantMatrix=h,this.mbWidth=this.width+15>>4,this.mbHeight=this.height+15>>4,this.mbSize=this.mbWidth*this.mbHeight,this.codedWidth=this.mbWidth<<4,this.codedHeight=this.mbHeight<<4,this.codedSize=this.codedWidth*this.codedHeight,this.halfWidth=this.mbWidth<<3,this.halfHeight=this.mbHeight<<3,this.quarterSize=this.codedSize>>2,!this.sequenceStarted){this.sequenceStarted=!0;var e=t.Uint8ClampedArray||t.Uint8Array;t.Uint8ClampedArray||(this.copyBlockToDestination=this.copyBlockToDestinationClamp,this.addBlockToDestination=this.addBlockToDestinationClamp),this.currentY=new e(this.codedSize),this.currentY32=new Uint32Array(this.currentY.buffer),this.currentCr=new e(this.codedSize>>2),this.currentCr32=new Uint32Array(this.currentCr.buffer),this.currentCb=new e(this.codedSize>>2),this.currentCb32=new Uint32Array(this.currentCb.buffer),this.forwardY=new e(this.codedSize),this.forwardY32=new Uint32Array(this.forwardY.buffer),this.forwardCr=new e(this.codedSize>>2),this.forwardCr32=new Uint32Array(this.forwardCr.buffer),this.forwardCb=new e(this.codedSize>>2),this.forwardCb32=new Uint32Array(this.forwardCb.buffer),this.canvas.width=this.width,this.canvas.height=this.height,this.gl?(this.gl.useProgram(this.program),this.gl.viewport(0,0,this.width,this.height)):(this.currentRGBA=this.canvasContext.getImageData(0,0,this.width,this.height),this.fillArray(this.currentRGBA.data,255))}},i.prototype.currentY=null,i.prototype.currentCr=null,i.prototype.currentCb=null,i.prototype.currentRGBA=null,i.prototype.pictureCodingType=0,i.prototype.forwardY=null,i.prototype.forwardCr=null,i.prototype.forwardCb=null,i.prototype.fullPelForward=!1,i.prototype.forwardFCode=0,i.prototype.forwardRSize=0,i.prototype.forwardF=0,i.prototype.decodePicture=function(t){if(!this._muted&&this.audio&&!this.audio.paused&&Math.abs(this.audio.currentTime-this.currentTime)>=.3){if(this.audio.currentTime==this._audioCurrentTime)return;this._audioCurrentTime=this.audio.currentTime;var e=Math.round(this.audio.currentTime*this.pictureRate);if(!(e>this.currentFrame||Math.abs(e-this.currentFrame)>.3))return;this.currentFrame=e;for(var i=null,r=0;r<this.intraFrames.length&&this.intraFrames[r].frame<=this.currentFrame;r++)i=this.intraFrames[r];this.buffer.index=i.index}else if(this.currentFrame++,this.currentFrame<2){for(var i=null,r=0;r<this.intraFrames.length&&this.intraFrames[r].frame<=this.currentFrame;r++)i=this.intraFrames[r];this.buffer.index=i.index}if(this.currentTime=this.currentFrame/this.pictureRate,this.buffer.advance(10),this.pictureCodingType=this.buffer.getBits(3),this.buffer.advance(16),!(this.pictureCodingType<=0||this.pictureCodingType>=F)){if(this.pictureCodingType==w){if(this.fullPelForward=this.buffer.getBits(1),this.forwardFCode=this.buffer.getBits(3),0==this.forwardFCode)return;this.forwardRSize=this.forwardFCode-1,this.forwardF=1<<this.forwardRSize}var s=0;do s=this.buffer.findNextMPEGStartCode();while(s==P||s==A);for(;s>=T&&x>=s;)this.decodeSlice(255&s),s=this.buffer.findNextMPEGStartCode();if(this.buffer.rewind(32),this.recordFrameFromCurrentBuffer(),t!=o&&(this.renderFrame(),this.externalDecodeCallback&&this.externalDecodeCallback(this,this.canvas)),this.pictureCodingType==g||this.pictureCodingType==w){var a=this.forwardY,n=this.forwardY32,h=this.forwardCr,d=this.forwardCr32,c=this.forwardCb,l=this.forwardCb32;this.forwardY=this.currentY,this.forwardY32=this.currentY32,this.forwardCr=this.currentCr,this.forwardCr32=this.currentCr32,this.forwardCb=this.currentCb,this.forwardCb32=this.currentCb32,this.currentY=a,this.currentY32=n,this.currentCr=h,this.currentCr32=d,this.currentCb=c,this.currentCb32=l}}},i.prototype.YCbCrToRGBA=function(){for(var t,e,i,r,o,s=this.currentY,a=this.currentCb,n=this.currentCr,h=this.currentRGBA.data,d=0,c=this.codedWidth,l=this.codedWidth+(this.codedWidth-this.width),u=0,f=this.halfWidth-(this.width>>1),p=0,m=4*this.width,y=4*this.width,b=this.width>>1,v=this.height>>1,g=0;v>g;g++){for(var w=0;b>w;w++){t=a[u],e=n[u],u++,i=e+(103*e>>8)-179,r=(88*t>>8)-44+(183*e>>8)-91,o=t+(198*t>>8)-227;var F=s[d++],C=s[d++];h[p]=F+i,h[p+1]=F-r,h[p+2]=F+o,h[p+4]=C+i,h[p+5]=C-r,h[p+6]=C+o,p+=8;var T=s[c++],x=s[c++];h[m]=T+i,h[m+1]=T-r,h[m+2]=T+o,h[m+4]=x+i,h[m+5]=x-r,h[m+6]=x+o,m+=8}d+=l,c+=l,p+=y,m+=y,u+=f}},i.prototype.renderFrame2D=function(){this.YCbCrToRGBA(),this.canvasContext.putImageData(this.currentRGBA,0,0)},i.prototype.gl=null,i.prototype.program=null,i.prototype.YTexture=null,i.prototype.CBTexture=null,i.prototype.CRTexture=null,i.prototype.createTexture=function(t,e){var i=this.gl,r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.uniform1i(i.getUniformLocation(this.program,e),t),r},i.prototype.compileShader=function(t,e){var i=this.gl,r=i.createShader(t);if(i.shaderSource(r,e),i.compileShader(r),!i.getShaderParameter(r,i.COMPILE_STATUS))throw new Error(i.getShaderInfoLog(r));return r},i.prototype.initWebGL=function(){try{var t=this.gl=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl")}catch(e){return!1}if(!t)return!1;if(this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,1]),t.STATIC_DRAW),this.program=t.createProgram(),t.attachShader(this.program,this.compileShader(t.VERTEX_SHADER,E)),t.attachShader(this.program,this.compileShader(t.FRAGMENT_SHADER,B)),t.linkProgram(this.program),!t.getProgramParameter(this.program,t.LINK_STATUS))throw new Error(t.getProgramInfoLog(this.program));t.useProgram(this.program),this.YTexture=this.createTexture(0,"YTexture"),this.CBTexture=this.createTexture(1,"CBTexture"),this.CRTexture=this.createTexture(2,"CRTexture");var i=t.getAttribLocation(this.program,"vertex");return t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),this.loadingProgram=t.createProgram(),t.attachShader(this.loadingProgram,this.compileShader(t.VERTEX_SHADER,E)),t.attachShader(this.loadingProgram,this.compileShader(t.FRAGMENT_SHADER,S)),t.linkProgram(this.loadingProgram),t.useProgram(this.loadingProgram),i=t.getAttribLocation(this.loadingProgram,"vertex"),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),!0},i.prototype.renderFrameGL=function(){var t=this.gl,e=new Uint8Array(this.currentY.buffer),i=new Uint8Array(this.currentCr.buffer),r=new Uint8Array(this.currentCb.buffer);t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.YTexture),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,this.codedWidth,this.height,0,t.LUMINANCE,t.UNSIGNED_BYTE,e),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.CBTexture),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,this.halfWidth,this.height/2,0,t.LUMINANCE,t.UNSIGNED_BYTE,i),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,this.CRTexture),t.texImage2D(t.TEXTURE_2D,0,t.LUMINANCE,this.halfWidth,this.height/2,0,t.LUMINANCE,t.UNSIGNED_BYTE,r),t.drawArrays(t.TRIANGLE_STRIP,0,4)},i.prototype.quantizerScale=0,i.prototype.sliceBegin=!1,i.prototype.decodeSlice=function(t){for(this.sliceBegin=!0,this.macroblockAddress=(t-1)*this.mbWidth-1,this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0,this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.quantizerScale=this.buffer.getBits(5);this.buffer.getBits(1);)this.buffer.advance(8);do this.decodeMacroblock();while(!this.buffer.nextBytesAreStartCode())},i.prototype.macroblockAddress=0,i.prototype.mbRow=0,i.prototype.mbCol=0,i.prototype.macroblockType=0,i.prototype.macroblockIntra=!1,i.prototype.macroblockMotFw=!1,i.prototype.motionFwH=0,i.prototype.motionFwV=0,i.prototype.motionFwHPrev=0,i.prototype.motionFwVPrev=0,i.prototype.decodeMacroblock=function(){for(var t=0,e=this.readCode(c);34==e;)e=this.readCode(c);for(;35==e;)t+=33,e=this.readCode(c);if(t+=e,this.sliceBegin)this.sliceBegin=!1,this.macroblockAddress+=t;else{if(this.macroblockAddress+t>=this.mbSize)return;for(t>1&&(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.pictureCodingType==w&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0));t>1;)this.macroblockAddress++,this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb),t--;this.macroblockAddress++}this.mbRow=this.macroblockAddress/this.mbWidth|0,this.mbCol=this.macroblockAddress%this.mbWidth,this.macroblockType=this.readCode(D[this.pictureCodingType]),this.macroblockIntra=1&this.macroblockType,this.macroblockMotFw=8&this.macroblockType,0!=(16&this.macroblockType)&&(this.quantizerScale=this.buffer.getBits(5)),this.macroblockIntra?(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0):(this.dcPredictorY=128,this.dcPredictorCr=128,this.dcPredictorCb=128,this.decodeMotionVectors(),this.copyMacroblock(this.motionFwH,this.motionFwV,this.forwardY,this.forwardCr,this.forwardCb));for(var i=0!=(2&this.macroblockType)?this.readCode(p):this.macroblockIntra?63:0,r=0,o=32;6>r;r++)0!=(i&o)&&this.decodeBlock(r),o>>=1},i.prototype.decodeMotionVectors=function(){var t,e,i=0;this.macroblockMotFw?(t=this.readCode(m),0!=t&&1!=this.forwardF?(i=this.buffer.getBits(this.forwardRSize),e=(Math.abs(t)-1<<this.forwardRSize)+i+1,0>t&&(e=-e)):e=t,this.motionFwHPrev+=e,this.motionFwHPrev>(this.forwardF<<4)-1?this.motionFwHPrev-=this.forwardF<<5:this.motionFwHPrev<-this.forwardF<<4&&(this.motionFwHPrev+=this.forwardF<<5),this.motionFwH=this.motionFwHPrev,this.fullPelForward&&(this.motionFwH<<=1),t=this.readCode(m),0!=t&&1!=this.forwardF?(i=this.buffer.getBits(this.forwardRSize),e=(Math.abs(t)-1<<this.forwardRSize)+i+1,0>t&&(e=-e)):e=t,this.motionFwVPrev+=e,this.motionFwVPrev>(this.forwardF<<4)-1?this.motionFwVPrev-=this.forwardF<<5:this.motionFwVPrev<-this.forwardF<<4&&(this.motionFwVPrev+=this.forwardF<<5),this.motionFwV=this.motionFwVPrev,this.fullPelForward&&(this.motionFwV<<=1)):this.pictureCodingType==w&&(this.motionFwH=this.motionFwHPrev=0,this.motionFwV=this.motionFwVPrev=0)},i.prototype.copyMacroblock=function(t,e,i,r,o){var s,a,n,h,d,c,l,u,f,p=this.currentY32,m=this.currentCb32,y=this.currentCr32;s=this.codedWidth,a=s-16,n=t>>1,h=e>>1,d=1==(1&t),c=1==(1&e),l=((this.mbRow<<4)+h)*s+(this.mbCol<<4)+n,u=this.mbRow*s+this.mbCol<<2,f=u+(s<<2);var b,v,g;if(d)if(c)for(;f>u;){b=i[l]+i[l+s],l++;for(var w=0;4>w;w++)v=i[l]+i[l+s],l++,g=b+v+2>>2&255,b=i[l]+i[l+s],l++,g|=b+v+2<<6&65280,v=i[l]+i[l+s],l++,g|=b+v+2<<14&16711680,b=i[l]+i[l+s],l++,g|=b+v+2<<22&4278190080,p[u++]=g;u+=a>>2,l+=a-1}else for(;f>u;){b=i[l++];for(var w=0;4>w;w++)v=i[l++],g=b+v+1>>1&255,b=i[l++],g|=b+v+1<<7&65280,v=i[l++],g|=b+v+1<<15&16711680,b=i[l++],g|=b+v+1<<23&4278190080,p[u++]=g;u+=a>>2,l+=a-1}else if(c)for(;f>u;){for(var w=0;4>w;w++)g=i[l]+i[l+s]+1>>1&255,l++,g|=i[l]+i[l+s]+1<<7&65280,l++,g|=i[l]+i[l+s]+1<<15&16711680,l++,g|=i[l]+i[l+s]+1<<23&4278190080,l++,p[u++]=g;u+=a>>2,l+=a}else for(;f>u;){for(var w=0;4>w;w++)g=i[l],l++,g|=i[l]<<8,l++,g|=i[l]<<16,l++,g|=i[l]<<24,l++,p[u++]=g;u+=a>>2,l+=a}s=this.halfWidth,a=s-8,n=t/2>>1,h=e/2>>1,d=1==(t/2&1),c=1==(e/2&1),l=((this.mbRow<<3)+h)*s+(this.mbCol<<3)+n,u=this.mbRow*s+this.mbCol<<1,f=u+(s<<1);var F,C,T,x,k,P;if(d)if(c)for(;f>u;){F=r[l]+r[l+s],x=o[l]+o[l+s],l++;for(var w=0;2>w;w++)C=r[l]+r[l+s],k=o[l]+o[l+s],l++,T=F+C+2>>2&255,P=x+k+2>>2&255,F=r[l]+r[l+s],x=o[l]+o[l+s],l++,T|=F+C+2<<6&65280,P|=x+k+2<<6&65280,C=r[l]+r[l+s],k=o[l]+o[l+s],l++,T|=F+C+2<<14&16711680,P|=x+k+2<<14&16711680,F=r[l]+r[l+s],x=o[l]+o[l+s],l++,T|=F+C+2<<22&4278190080,P|=x+k+2<<22&4278190080,y[u]=T,m[u]=P,u++;u+=a>>2,l+=a-1}else for(;f>u;){F=r[l],x=o[l],l++;for(var w=0;2>w;w++)C=r[l],k=o[l++],T=F+C+1>>1&255,P=x+k+1>>1&255,F=r[l],x=o[l++],T|=F+C+1<<7&65280,P|=x+k+1<<7&65280,C=r[l],k=o[l++],T|=F+C+1<<15&16711680,P|=x+k+1<<15&16711680,F=r[l],x=o[l++],T|=F+C+1<<23&4278190080,P|=x+k+1<<23&4278190080,y[u]=T,m[u]=P,u++;u+=a>>2,l+=a-1}else if(c)for(;f>u;){for(var w=0;2>w;w++)T=r[l]+r[l+s]+1>>1&255,P=o[l]+o[l+s]+1>>1&255,l++,T|=r[l]+r[l+s]+1<<7&65280,P|=o[l]+o[l+s]+1<<7&65280,l++,T|=r[l]+r[l+s]+1<<15&16711680,P|=o[l]+o[l+s]+1<<15&16711680,l++,T|=r[l]+r[l+s]+1<<23&4278190080,P|=o[l]+o[l+s]+1<<23&4278190080,l++,y[u]=T,m[u]=P,u++;u+=a>>2,l+=a}else for(;f>u;){for(var w=0;2>w;w++)T=r[l],P=o[l],l++,T|=r[l]<<8,P|=o[l]<<8,l++,T|=r[l]<<16,P|=o[l]<<16,l++,T|=r[l]<<24,P|=o[l]<<24,l++,y[u]=T,m[u]=P,u++;u+=a>>2,l+=a}},i.prototype.dcPredictorY,i.prototype.dcPredictorCr,i.prototype.dcPredictorCb,i.prototype.blockData=null,i.prototype.decodeBlock=function(t){var e,i=0;if(this.macroblockIntra){var r,o;if(4>t?(r=this.dcPredictorY,o=this.readCode(y)):(r=4==t?this.dcPredictorCr:this.dcPredictorCb,o=this.readCode(b)),o>0){var s=this.buffer.getBits(o);0!=(s&1<<o-1)?this.blockData[0]=r+s:this.blockData[0]=r+(-1<<o|s+1)}else this.blockData[0]=r;4>t?this.dcPredictorY=this.blockData[0]:4==t?this.dcPredictorCr=this.blockData[0]:this.dcPredictorCb=this.blockData[0],this.blockData[0]<<=8,e=this.intraQuantMatrix,i=1}else e=this.nonIntraQuantMatrix;for(var n=0;;){var h=0,c=this.readCode(v);if(1==c&&i>0&&0==this.buffer.getBits(1))break;65535==c?(h=this.buffer.getBits(6),n=this.buffer.getBits(8),0==n?n=this.buffer.getBits(8):128==n?n=this.buffer.getBits(8)-256:n>128&&(n-=256)):(h=c>>8,n=255&c,this.buffer.getBits(1)&&(n=-n)),i+=h;var l=a[i];i++,n<<=1,this.macroblockIntra||(n+=0>n?-1:1),n=n*this.quantizerScale*e[l]>>4,0==(1&n)&&(n-=n>0?1:-1),n>2047?n=2047:-2048>n&&(n=-2048),this.blockData[l]=n*d[l]}var u,f,p;4>t?(u=this.currentY,p=this.codedWidth-8,f=this.mbRow*this.codedWidth+this.mbCol<<4,0!=(1&t)&&(f+=8),0!=(2&t)&&(f+=this.codedWidth<<3)):(u=4==t?this.currentCb:this.currentCr,p=(this.codedWidth>>1)-8,f=(this.mbRow*this.codedWidth<<2)+(this.mbCol<<3)),this.macroblockIntra?1==i?(this.copyValueToDestination(this.blockData[0]+128>>8,u,f,p),this.blockData[0]=0):(this.IDCT(),this.copyBlockToDestination(this.blockData,u,f,p),this.blockData.set(this.zeroBlockData)):1==i?(this.addValueToDestination(this.blockData[0]+128>>8,u,f,p),this.blockData[0]=0):(this.IDCT(),this.addBlockToDestination(this.blockData,u,f,p),this.blockData.set(this.zeroBlockData)),i=0},i.prototype.copyBlockToDestination=function(t,e,i,r){for(var o=0;64>o;o+=8,i+=r+8)e[i+0]=t[o+0],e[i+1]=t[o+1],e[i+2]=t[o+2],e[i+3]=t[o+3],e[i+4]=t[o+4],e[i+5]=t[o+5],e[i+6]=t[o+6],e[i+7]=t[o+7]},i.prototype.addBlockToDestination=function(t,e,i,r){for(var o=0;64>o;o+=8,i+=r+8)e[i+0]+=t[o+0],e[i+1]+=t[o+1],e[i+2]+=t[o+2],e[i+3]+=t[o+3],e[i+4]+=t[o+4],e[i+5]+=t[o+5],e[i+6]+=t[o+6],e[i+7]+=t[o+7]},i.prototype.copyValueToDestination=function(t,e,i,r){for(var o=0;64>o;o+=8,i+=r+8)e[i+0]=t,e[i+1]=t,e[i+2]=t,e[i+3]=t,e[i+4]=t,e[i+5]=t,e[i+6]=t,e[i+7]=t},i.prototype.addValueToDestination=function(t,e,i,r){for(var o=0;64>o;o+=8,i+=r+8)e[i+0]+=t,e[i+1]+=t,e[i+2]+=t,e[i+3]+=t,e[i+4]+=t,e[i+5]+=t,e[i+6]+=t,e[i+7]+=t},i.prototype.copyBlockToDestinationClamp=function(t,e,i,r){for(var o=0,s=0;8>s;s++){for(var a=0;8>a;a++){var n=t[o++];e[i++]=n>255?255:0>n?0:n}i+=r}},i.prototype.addBlockToDestinationClamp=function(t,e,i,r){for(var o=0,s=0;8>s;s++){for(var a=0;8>a;a++){var n=t[o++]+e[i];e[i++]=n>255?255:0>n?0:n}i+=r}},i.prototype.IDCT=function(){var t,e,i,r,o,s,a,n,h,d,c,l,u,f,p,m,y,b,v,g=this.blockData;for(v=0;8>v;++v)t=g[32+v],e=g[16+v]+g[48+v],i=g[40+v]-g[24+v],s=g[8+v]+g[56+v],a=g[24+v]+g[40+v],r=g[8+v]-g[56+v],o=s+a,n=g[0+v],u=(473*r-196*i+128>>8)-o,h=u-(362*(s-a)+128>>8),d=n-t,c=(362*(g[16+v]-g[48+v])+128>>8)-e,l=n+t,f=d+c,p=l+e,m=d-c,y=l-e,b=-h-(473*i+196*r+128>>8),g[0+v]=o+p,g[8+v]=u+f,g[16+v]=m-h,g[24+v]=y-b,g[32+v]=y+b,g[40+v]=h+m,g[48+v]=f-u,g[56+v]=p-o;for(v=0;64>v;v+=8)t=g[4+v],e=g[2+v]+g[6+v],i=g[5+v]-g[3+v],s=g[1+v]+g[7+v],a=g[3+v]+g[5+v],r=g[1+v]-g[7+v],o=s+a,n=g[0+v],u=(473*r-196*i+128>>8)-o,h=u-(362*(s-a)+128>>8),d=n-t,c=(362*(g[2+v]-g[6+v])+128>>8)-e,l=n+t,f=d+c,p=l+e,m=d-c,y=l-e,b=-h-(473*i+196*r+128>>8),g[0+v]=o+p+128>>8,g[1+v]=u+f+128>>8,g[2+v]=m-h+128>>8,g[3+v]=y-b+128>>8,g[4+v]=y+b+128>>8,g[5+v]=h+m+128>>8,g[6+v]=f-u+128>>8,g[7+v]=p-o+128>>8};var r="jsmp",o=1,s=[0,23.976,24,25,29.97,30,50,59.94,60,0,0,0,0,0,0,0],a=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),n=new Uint8Array([8,16,19,22,26,27,29,34,16,16,22,24,27,29,34,37,19,22,26,27,29,34,34,38,22,22,26,27,29,34,37,40,22,26,27,29,32,35,40,48,26,27,29,32,35,40,48,58,26,27,29,34,38,46,56,69,27,29,35,38,46,56,69,83]),h=new Uint8Array([16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16]),d=new Uint8Array([32,44,42,38,32,25,17,9,44,62,58,52,44,35,24,12,42,58,55,49,42,33,23,12,38,52,49,44,38,30,20,10,32,44,42,38,32,25,17,9,25,35,33,30,25,20,14,7,17,24,23,20,17,14,9,5,9,12,12,10,9,7,5,2]),c=new Int16Array([3,6,0,9,12,0,0,0,1,15,18,0,21,24,0,27,30,0,33,36,0,0,0,3,0,0,2,39,42,0,45,48,0,0,0,5,0,0,4,51,54,0,57,60,0,0,0,7,0,0,6,63,66,0,69,72,0,75,78,0,81,84,0,-1,87,0,-1,90,0,93,96,0,99,102,0,105,108,0,111,114,0,0,0,9,0,0,8,117,120,0,123,126,0,129,132,0,135,138,0,0,0,15,0,0,14,0,0,13,0,0,12,0,0,11,0,0,10,141,-1,0,-1,144,0,147,150,0,153,156,0,159,162,0,165,168,0,171,174,0,177,180,0,183,-1,0,-1,186,0,189,192,0,195,198,0,201,204,0,207,210,0,213,216,0,219,222,0,0,0,21,0,0,20,0,0,19,0,0,18,0,0,17,0,0,16,0,0,35,0,0,34,0,0,33,0,0,32,0,0,31,0,0,30,0,0,29,0,0,28,0,0,27,0,0,26,0,0,25,0,0,24,0,0,23,0,0,22]),l=new Int8Array([3,6,0,-1,9,0,0,0,1,0,0,17]),u=new Int8Array([3,6,0,9,12,0,0,0,10,15,18,0,0,0,2,21,24,0,0,0,8,27,30,0,33,36,0,-1,39,0,0,0,18,0,0,26,0,0,1,0,0,17]),f=new Int8Array([3,6,0,9,15,0,12,18,0,24,21,0,0,0,12,27,30,0,0,0,14,39,42,0,36,33,0,0,0,4,0,0,6,54,48,0,45,51,0,0,0,8,0,0,10,-1,57,0,0,0,1,60,63,0,0,0,30,0,0,17,0,0,22,0,0,26]),p=new Int16Array([6,3,0,9,18,0,12,15,0,24,33,0,36,39,0,27,21,0,30,42,0,60,57,0,54,48,0,69,51,0,81,75,0,63,84,0,45,66,0,72,78,0,0,0,60,105,120,0,132,144,0,114,108,0,126,141,0,87,93,0,117,96,0,0,0,32,135,138,0,99,123,0,129,102,0,0,0,4,90,111,0,0,0,8,0,0,16,0,0,44,150,168,0,0,0,28,0,0,52,0,0,62,183,177,0,156,180,0,0,0,1,165,162,0,0,0,61,0,0,56,171,174,0,0,0,2,0,0,40,153,186,0,0,0,48,192,189,0,147,159,0,0,0,20,0,0,12,240,249,0,0,0,63,231,225,0,195,219,0,252,198,0,0,0,24,0,0,36,0,0,3,207,261,0,243,237,0,204,213,0,210,234,0,201,228,0,216,222,0,258,255,0,264,246,0,-1,282,0,285,291,0,0,0,33,0,0,9,318,330,0,306,348,0,0,0,5,0,0,10,279,267,0,0,0,6,0,0,18,0,0,17,0,0,34,339,357,0,309,312,0,270,276,0,327,321,0,351,354,0,303,297,0,294,288,0,300,273,0,342,345,0,315,324,0,336,333,0,363,375,0,0,0,41,0,0,14,0,0,21,372,366,0,360,369,0,0,0,11,0,0,19,0,0,7,0,0,35,0,0,13,0,0,50,0,0,49,0,0,58,0,0,37,0,0,25,0,0,45,0,0,57,0,0,26,0,0,29,0,0,38,0,0,53,0,0,23,0,0,43,0,0,46,0,0,42,0,0,22,0,0,54,0,0,51,0,0,15,0,0,30,0,0,39,0,0,47,0,0,55,0,0,27,0,0,59,0,0,31]),m=new Int16Array([3,6,0,12,9,0,0,0,0,18,15,0,24,21,0,0,0,-1,0,0,1,27,30,0,36,33,0,0,0,2,0,0,-2,42,45,0,48,39,0,60,54,0,0,0,3,0,0,-3,51,57,0,-1,69,0,81,75,0,78,63,0,72,66,0,96,84,0,87,93,0,-1,99,0,108,105,0,0,0,-4,90,102,0,0,0,4,0,0,-7,0,0,5,111,123,0,0,0,-5,0,0,7,114,120,0,126,117,0,0,0,-6,0,0,6,153,162,0,150,147,0,135,138,0,156,141,0,129,159,0,132,144,0,0,0,10,0,0,9,0,0,8,0,0,-8,171,198,0,0,0,-9,180,192,0,168,183,0,165,186,0,174,189,0,0,0,-10,177,195,0,0,0,12,0,0,16,0,0,13,0,0,14,0,0,11,0,0,15,0,0,-16,0,0,-12,0,0,-14,0,0,-15,0,0,-11,0,0,-13]),y=new Int8Array([6,3,0,18,15,0,9,12,0,0,0,1,0,0,2,27,24,0,21,30,0,0,0,0,36,33,0,0,0,4,0,0,3,39,42,0,0,0,5,0,0,6,48,45,0,51,-1,0,0,0,7,0,0,8]),b=new Int8Array([6,3,0,12,9,0,18,15,0,24,21,0,0,0,2,0,0,1,0,0,0,30,27,0,0,0,3,36,33,0,0,0,4,42,39,0,0,0,5,48,45,0,0,0,6,51,-1,0,0,0,7,0,0,8]),v=new Int32Array([3,6,0,12,9,0,0,0,1,21,24,0,18,15,0,39,27,0,33,30,0,42,36,0,0,0,257,60,66,0,54,63,0,48,57,0,0,0,513,51,45,0,0,0,2,0,0,3,81,75,0,87,93,0,72,78,0,96,90,0,0,0,1025,69,84,0,0,0,769,0,0,258,0,0,1793,0,0,65535,0,0,1537,111,108,0,0,0,1281,105,102,0,117,114,0,99,126,0,120,123,0,156,150,0,162,159,0,144,147,0,129,135,0,138,132,0,0,0,2049,0,0,4,0,0,514,0,0,2305,153,141,0,165,171,0,180,168,0,177,174,0,183,186,0,0,0,2561,0,0,3329,0,0,6,0,0,259,0,0,5,0,0,770,0,0,2817,0,0,3073,228,225,0,201,210,0,219,213,0,234,222,0,216,231,0,207,192,0,204,189,0,198,195,0,243,261,0,273,240,0,246,237,0,249,258,0,279,276,0,252,255,0,270,282,0,264,267,0,0,0,515,0,0,260,0,0,7,0,0,1026,0,0,1282,0,0,4097,0,0,3841,0,0,3585,315,321,0,333,342,0,312,291,0,375,357,0,288,294,0,-1,369,0,285,303,0,318,363,0,297,306,0,339,309,0,336,348,0,330,300,0,372,345,0,351,366,0,327,354,0,360,324,0,381,408,0,417,420,0,390,378,0,435,438,0,384,387,0,0,0,2050,396,402,0,465,462,0,0,0,8,411,399,0,429,432,0,453,414,0,426,423,0,0,0,10,0,0,9,0,0,11,0,0,5377,0,0,1538,0,0,771,0,0,5121,0,0,1794,0,0,4353,0,0,4609,0,0,4865,444,456,0,0,0,1027,459,450,0,0,0,261,393,405,0,0,0,516,447,441,0,516,519,0,486,474,0,510,483,0,504,498,0,471,537,0,507,501,0,522,513,0,534,531,0,468,477,0,492,495,0,549,546,0,525,528,0,0,0,263,0,0,2562,0,0,2306,0,0,5633,0,0,5889,0,0,6401,0,0,6145,0,0,1283,0,0,772,0,0,13,0,0,12,0,0,14,0,0,15,0,0,517,0,0,6657,0,0,262,540,543,0,480,489,0,588,597,0,0,0,27,609,555,0,606,603,0,0,0,19,0,0,22,591,621,0,0,0,18,573,576,0,564,570,0,0,0,20,552,582,0,0,0,21,558,579,0,0,0,23,612,594,0,0,0,25,0,0,24,600,615,0,0,0,31,0,0,30,0,0,28,0,0,29,0,0,26,0,0,17,0,0,16,567,618,0,561,585,0,654,633,0,0,0,37,645,648,0,0,0,36,630,636,0,0,0,34,639,627,0,663,666,0,657,624,0,651,642,0,669,660,0,0,0,35,0,0,267,0,0,40,0,0,268,0,0,266,0,0,32,0,0,264,0,0,265,0,0,38,0,0,269,0,0,270,0,0,33,0,0,39,0,0,7937,0,0,6913,0,0,7681,0,0,4098,0,0,7425,0,0,7169,0,0,271,0,0,274,0,0,273,0,0,272,0,0,1539,0,0,2818,0,0,3586,0,0,3330,0,0,3074,0,0,3842]),g=1,w=2,F=3,C=179,T=1,x=175,k=0,P=181,A=178,B=["precision mediump float;","uniform sampler2D YTexture;","uniform sampler2D CBTexture;","uniform sampler2D CRTexture;","varying vec2 texCoord;","void main() {","float y = texture2D(YTexture, texCoord).r;","float cr = texture2D(CBTexture, texCoord).r - 0.5;","float cb = texture2D(CRTexture, texCoord).r - 0.5;","gl_FragColor = vec4(","y + 1.4 * cr,","y + -0.343 * cb - 0.711 * cr,","y + 1.765 * cb,","1.0",");","}"].join("\n"),S=["precision mediump float;","uniform float loaded;","varying vec2 texCoord;","void main() {","float c = ceil(loaded-(1.0-texCoord.y));","gl_FragColor = vec4(c,c,c,1);","}"].join("\n"),E=["attribute vec2 vertex;","varying vec2 texCoord;","void main() {","texCoord = vertex;","gl_Position = vec4((vertex * 2.0 - 1.0) * vec2(1, -1), 0.0, 1.0);","}"].join("\n"),D=[null,l,u,f],R=function(t){this.bytes=new Uint8Array(t),this.length=this.bytes.length,this.writePos=this.bytes.length,this.index=0};R.NOT_FOUND=-1,R.prototype.findNextMPEGStartCode=function(){for(var t=this.index+7>>3;t<this.writePos;t++)if(0==this.bytes[t]&&0==this.bytes[t+1]&&1==this.bytes[t+2])return this.index=t+4<<3,
this.bytes[t+3];return this.index=this.writePos<<3,R.NOT_FOUND},R.prototype.nextBytesAreStartCode=function(){var t=this.index+7>>3;return t>=this.writePos||0==this.bytes[t]&&0==this.bytes[t+1]&&1==this.bytes[t+2]},R.prototype.nextBits=function(t){var e=this.index>>3,i=8-this.index%8;if(i>=t)return this.bytes[e]>>i-t&255>>8-t;var r=(this.index+t)%8,o=this.index+t-1>>3,s=this.bytes[e]&255>>8-i;for(e++;o>e;e++)s<<=8,s|=this.bytes[e];return r>0?(s<<=r,s|=this.bytes[e]>>8-r):(s<<=8,s|=this.bytes[e]),s},R.prototype.getBits=function(t){var e=this.nextBits(t);return this.index+=t,e},R.prototype.advance=function(t){return this.index+=t},R.prototype.rewind=function(t){return this.index-=t}}}(window),function(t){"object"==typeof module&&"object"==typeof module.exports?(console.log("OrzVideo load with commonJS"),module.exports=t()):(console.log("OrzVideo load with normal"),t())}(function(){function t(){for(var t,e={},i=0,r=arguments.length;r>i;++i)for(t in arguments[i])arguments[i].hasOwnProperty(t)&&(e[t]=arguments[i][t]);return e}function e(){this.container.appendChild(this.video),this.container.appendChild(this.firstFrame),this.container.appendChild(this.endFrame);var t=getComputedStyle(this.container).position;this.loading.style.display="none",t.match(/relative|absolute|fixed/i)||(this.container.style.position="relative"),this.video.style.position="relative",this.video.style.zIndex=2,this.video.style.visibility="hidden",this.video.classList.add("content"),this.firstFrame.style.position="absolute",this.firstFrame.style.top=0,this.firstFrame.style.left=0,this.firstFrame.style.zIndex=3,this.firstFrame.style.display="block",this.endFrame.style.position="absolute",this.endFrame.style.top=0,this.endFrame.style.left=0,this.endFrame.style.zIndex=3,this.endFrame.style.display="none"}function i(){var t=this;t.video.addEventListener("play",function(){t.firstFrame.style.display="none",t.endFrame.style.display="none",t.video.style.visibility="visible",t.flag_loading=setInterval(function(){t.prevTime==t.video.currentTime?t.loading.style.display="block":(t.loading.style.display="none",t.prevTime=t.video.currentTime)},40),t.playHandler.call()},!1),t.video.addEventListener("pause",function(){r.call(t),t.pauseHandler.call()},!1),t.video.addEventListener("ended",function(){r.call(t),t.resetWhenEnd?(t.firstFrame.style.display="block",t.video.style.visibility="hidden",t.video.currentTime=0):(t.endFrame.style.display="block",t.video.style.visibility="hidden"),t.endHandler.call()},!1),t.video.addEventListener("click",function(){t.clickHandler.call()}),t.video.addEventListener("playing",function(){t.playingHandler.call()}),t.video.addEventListener("timeupdate",function(){t.updateHandler.call()})}function r(){clearInterval(this.flag_loading),this.loading.style.display="none"}function o(){this.container.appendChild(this.canvas),this.container.appendChild(this.firstFrame),this.container.appendChild(this.endFrame);var t=getComputedStyle(this.container).position;this.loading.style.display="none",t.match(/relative|absolute|fixed/i)||(this.container.style.position="relative"),this.canvas.style.position="relative",this.canvas.style.zIndex=2,this.canvas.style.display="none",this.canvas.classList.add("content"),this.firstFrame.style.position="absolute",this.firstFrame.style.top=0,this.firstFrame.style.left=0,this.firstFrame.style.zIndex=3,this.firstFrame.style.display="block",this.endFrame.style.position="absolute",this.endFrame.style.top=0,this.endFrame.style.left=0,this.endFrame.style.zIndex=3,this.endFrame.style.display="none"}function s(){var t=this;t.canvas.addEventListener("click",function(){t.clickHandler.call()})}function a(){var t=this;t.paused=!0,n.call(t),t.video.stop(),t.video.play(),t.video.pause(),t.audio.pause(),t.audio.currentTime=0,t.resetWhenEnd?(t.firstFrame.style.display="block",t.canvas.style.visibility="hidden"):(t.endFrame.style.display="block",t.canvas.style.visibility="hidden"),t.endHandler.call()}function n(){clearInterval(this.flag_loading),this.loading.style.display="none"}var h=window.navigator.userAgent.toLowerCase(),d=null!==h.match(/Android|webOS|iPhone|iPod|BlackBerry|IEMobile/i)&&null!==h.match(/Mobile/i),c=(null!==h.match(/iphone/i),null!==h.match(/android/i),d),l={resetWhenEnd:!1,muted:!1,onplay:function(){},onpause:function(){},onend:function(){},onclick:function(){},onplaying:function(){},onupdate:function(){}},u=function(e){var i=t({},l,e);return c?new p(i):new f(i)},f=function(t){this.container=t.container,this.loading=this.container.querySelector(".loading"),this.video=document.createElement("video"),this.firstFrame=new Image,this.endFrame=new Image,this.video.src=t.video,this.video.muted=t.muted,this.video.preload="",this.firstFrame.src=t.firstFrame,this.endFrame.src=t.endFrame,this.resetWhenEnd=t.resetWhenEnd,this.playHandler=t.onplay,this.pauseHandler=t.onpause,this.endHandler=t.onend,this.clickHandler=t.onclick,this.playingHandler=t.onplaying,this.updateHandler=t.onupdate,e.call(this),i.call(this),Object.defineProperties(this,{paused:{get:function(){return this.video.paused}},muted:{get:function(){return this.video.muted},set:function(t){this.video.muted=t}},currentTime:{get:function(){return this.video.currentTime}}})};f.prototype.play=function(){this.paused&&this.video.play()},f.prototype.pause=function(){this.paused||this.video.pause()},f.prototype.stop=function(){this.video.pause(),this.video.currentTime=0,this.firstFrame.style.display="block",this.video.style.visibility="hidden"};var p=function(t){var e=this;this.container=t.container,this.loading=this.container.querySelector(".loading"),this.canvas=document.createElement("canvas"),this.audio=new Audio,this.firstFrame=new Image,this.endFrame=new Image,this.loaded=!1,this.autoplay=!1,this.video=new jsmpeg(t.mpg,{canvas:this.canvas,seekable:!0,preload:!0,forceCanvas2D:!0,onload:function(){e.loaded=!0,e.autoplay&&e.play()},onfinished:function(){a.call(e)}}),this.audio.src=t.audio,this.audio.play(),this.audio.pause(),this.ispaused=!0,this.ismuted=t.muted,this.firstFrame.src=t.firstFrame,this.endFrame.src=t.endFrame,this.resetWhenEnd=t.resetWhenEnd,this.playHandler=t.onplay,this.pauseHandler=t.onpause,this.endHandler=t.onend,this.clickHandler=t.onclick,o.call(e),s.call(e),Object.defineProperties(this,{paused:{get:function(){return this.ispaused},set:function(t){this.ispaused=t}},currentTime:{get:function(){return this.video.currentTime}},muted:{get:function(){return this.ismuted},set:function(t){t!=this.ismuted&&(this.ismuted=t,this.ismuted?this.audio.pause():(this.audio.currentTime=this.currentTime,this.ispaused||this.audio.play()))}}})};return p.prototype.play=function(){var t=this;return t.loaded?void(t.paused&&(t.paused=!1,t.video.play(),this.ismuted?this.audio.pause():this.audio.play(),t.firstFrame.style.display="none",t.endFrame.style.display="none",t.canvas.style.visibility="visible",t.flag_loading=setInterval(function(){t.muted||(t.prevTime==t.audio.currentTime?(t.loading.style.display="block",t.video.pause()):(t.loading.style.display="none",t.prevTime=t.audio.currentTime,t.video.play()))},40),t.playHandler.call())):(t.autoplay=!0,void(t.loading.style.display="block"))},p.prototype.pause=function(){var t=this;return t.loaded?void(t.paused||(t.paused=!0,t.video.pause(),t.audio.pause(),n.call(t),t.pauseHandler.call())):(t.autoplay=!1,void(t.loading.style.display="none"))},p.prototype.stop=function(){var t=this;return t.loaded?(t.paused=!0,n.call(t),t.video.stop(),t.video.play(),t.video.pause(),t.audio.pause(),t.audio.currentTime=0,t.firstFrame.style.display="block",void(t.canvas.style.visibility="hidden")):void(t.autoplay=!1)},window.OrzVideo=u,u});